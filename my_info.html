<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Rey Pantorilla - Portfolio</title>
  <style>
    /* RESET & BASE */
    * { margin:0; padding:0; box-sizing:border-box; font-family:"Poppins", sans-serif; }
    body { background: radial-gradient(circle at top left, #0b1b3a, #020614); color:#fff; overflow-x:hidden; }
    a { text-decoration:none; }

    /* HEADER */
    header { width:100%; padding:20px 60px; display:flex; justify-content:space-between; align-items:center; position:fixed; top:0; z-index:1000; backdrop-filter:blur(10px); }
    header .logo { font-weight:700; font-size:1.6rem; color:#4da6ff; }
    header nav a { color:#b7c6ff; margin-left:30px; transition:0.3s; }
    header nav a:hover { color:#4da6ff; }
    @media(max-width:768px){ header { padding:12px 25px; } header nav a { margin-left:15px; font-size:0.9rem; } }

    /* HERO */
    .hero { padding:180px 60px 120px; display:flex; flex-wrap:wrap; align-items:center; justify-content:space-between; opacity:0; transform:translateY(30px); transition:1s ease-out; }
    .hero.show { opacity:1; transform:translateY(0); }
    .hero-text h3 { font-weight:400; font-size:1.3rem; color:#b7c6ff; margin-bottom:10px; opacity:0; transform:translateY(20px); transition:0.6s ease-out 0.2s; }
    .hero-text h3.show { opacity:1; transform:translateY(0); }
    .hero-text h1 { font-size:3.5rem; margin-bottom:10px; opacity:0; transform:translateY(20px); transition:0.6s ease-out 0.4s; }
    .hero-text h1.show { opacity:1; transform:translateY(0); }
    .hero-text h2 { font-weight:400; color:#45aaff; margin-bottom:20px; opacity:0; transform:translateY(20px); transition:0.6s ease-out 0.6s; }
    .hero-text h2.show { opacity:1; transform:translateY(0); }
    .hero-text p { width:85%; margin-bottom:25px; color:#c0c9e9; line-height:1.6; opacity:0; transform:translateY(20px); transition:0.6s ease-out 0.8s; }
    .hero-text p.show { opacity:1; transform:translateY(0); }
    .btn { background:#1679f5; color:#fff; padding:10px 20px; border-radius:6px; margin-right:10px; display:inline-block; transition:0.3s; }
    .btn:hover { background:#0f5ccc; box-shadow:0 5px 15px rgba(77,166,255,0.5); }

    .hero-img { width:420px; height:280px; border-radius:12px; overflow:hidden; transform-style: preserve-3d; transition: transform 0.4s ease, opacity 1s; cursor:pointer; opacity:0; }
    .hero-img.show { opacity:1; }
    .hero-img img { width:100%; height:100%; object-fit:cover; }
    .hero-img:hover { transform: perspective(900px) rotateY(12deg) rotateX(6deg) scale(1.03); }

    @media(max-width:768px){ .hero { padding:120px 25px; } .hero-text h1 { font-size:2.4rem; } .hero-img { width:100%; height:auto; margin-top:25px; } .hero-text p { width:100%; } }

    /* SECTION TITLES */
    section { padding:100px 60px; opacity:0; transform:translateY(30px); transition:1s ease-out; }
    section.show { opacity:1; transform:translateY(0); }
    h2.section-title { font-size:2.8rem; margin-bottom:40px; }
    h2.section-title span { color:#4da6ff; }

    /* ABOUT */
    .about-container { display: flex; flex-wrap: wrap; gap: 40px; justify-content: space-between; align-items: flex-start; }
    .about-intro { flex: 1 1 300px; display: flex; flex-direction: column; align-items: center; text-align: center; gap: 15px; }
    .about-img { width: 180px; height: 180px; border-radius: 50%; object-fit: cover; border: 3px solid #4da6ff; transition: transform 0.3s; }
    .about-img:hover { transform: scale(1.05); }
    .about-intro p { color: #c0c9e9; font-size: 1rem; line-height: 1.6; }
    .about-boxes { flex: 2 1 600px; display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
    .about-card { background: rgba(255,255,255,0.05); padding: 25px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.1); transition: transform 0.4s, background 0.3s, opacity 1s; text-align: center; opacity:0; }
    .about-card.show { opacity:1; transform: translateY(0); }
    .about-card h3 { margin-bottom: 10px; color: #4da6ff; }
    .about-card p { color: #c0c9e9; font-size: 0.95rem; }
    .about-card:hover { transform: translateY(-8px) scale(1.03); background: rgba(77, 166, 255, 0.1); }

    @media (max-width: 768px) { .about-container { flex-direction: column; gap: 25px; } .about-intro p { width: 100%; } }

    /* PROJECTS */
    .projects-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px; }
    .project-card { background: rgba(255,255,255,0.05); border-radius: 12px; overflow: hidden; cursor: pointer; transition: transform 0.4s, box-shadow 0.4s, opacity 1s; opacity:0; }
    .project-card.show { opacity:1; }
    .project-card img { width: 100%; height: 180px; object-fit: cover; border-bottom: 1px solid rgba(255,255,255,0.1); transition: transform 0.3s; }
    .project-card:hover img { transform: scale(1.05); }
    .project-content { padding: 15px; }
    .project-content h3 { color: #4da6ff; margin-bottom: 8px; }
    .project-content p { font-size: 0.95rem; color: #c0c9e9; }

    /* SKILLS */
    .skills-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(150px,1fr)); gap:20px; }
    .skill-box { margin-bottom:15px; opacity:0; transform:translateY(20px); transition:0.8s ease-out; }
    .skill-box.show { opacity:1; transform:translateY(0); }
    .skill-name { margin-bottom:6px; font-weight:500; }
    .skill-bar { background:rgba(255,255,255,0.05); border-radius:12px; height:12px; overflow:hidden; }
    .skill-bar-fill { height:100%; border-radius:12px; background:#45aaff; width:0; transition: width 1.2s ease-in-out; }

    /* CONTACT */
    .contact-container {
  display: flex;
  flex-wrap: wrap;
  gap: 50px;
  justify-content: center;
  align-items: flex-start;
}

.contact-form {
  flex: 1 1 400px;
  background: rgba(255,255,255,0.05);
  padding: 30px;
  border-radius: 12px;
  backdrop-filter: blur(5px);
  transition: transform 0.3s, box-shadow 0.3s;
}

.contact-form:hover {
  transform: translateY(-5px) scale(1.02);
  box-shadow: 0 15px 30px rgba(0,0,0,0.3);
}

.input-group {
  position: relative;
  margin-bottom: 20px;
}

.input-group input,
.input-group textarea {
  width: 100%;
  padding: 12px 12px 12px 0;
  border: none;
  border-bottom: 2px solid #4da6ff;
  background: transparent;
  color: #fff;
  font-size: 1rem;
  transition: border-color 0.3s;
}

.input-group input:focus,
.input-group textarea:focus {
  outline: none;
  border-bottom-color: #45aaff;
}

.input-group label {
  position: absolute;
  left: 0;
  top: 12px;
  color: #c0c9e9;
  font-size: 0.9rem;
  pointer-events: none;
  transition: 0.3s ease all;
}

.input-group input:focus + label,
.input-group input:not(:placeholder-shown) + label,
.input-group textarea:focus + label,
.input-group textarea:not(:placeholder-shown) + label {
  top: -10px;
  font-size: 0.75rem;
  color: #4da6ff;
}

.contact-form button {
  width: 100%;
  padding: 12px;
  border-radius: 8px;
  border: none;
  background: #4da6ff;
  color: #fff;
  font-weight: 500;
  cursor: pointer;
  transition: background 0.3s, transform 0.2s;
}

.contact-form button:hover {
  background: #45aaff;
  transform: scale(1.02);
}

.contact-info {
  flex: 1 1 300px;
  text-align: center;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 15px;
}

.contact-info .contact-img {
  width: 250px;
  border-radius: 12px;
  border: 2px solid #4da6ff;
  transition: transform 0.3s;
}

.contact-info .contact-img:hover {
  transform: scale(1.05);
}

.contact-info .info-text {
  color: #c0c9e9;
  font-size: 0.95rem;
  line-height: 1.6;
  max-width: 300px;
}

.form-feedback {
  color: #4da6ff;
  margin-top: 10px;
  font-size: 0.9rem;
  text-align: center;
}

.social-icons {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin-top: 20px;
}

.social-icons a img {
  width: 40px;
  transition: transform 0.3s, filter 0.3s;
  filter: brightness(0.8);
}

.social-icons a img:hover {
  transform: scale(1.2) rotate(10deg);
  filter: brightness(1);
}

.contact-form {
  flex: 1 1 400px;
  background: rgba(255,255,255,0.05);
  padding: 30px;
  border-radius: 12px;
  backdrop-filter: blur(5px);
  transition: transform 0.3s, box-shadow 0.3s;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.contact-form:hover {
  transform: translateY(-5px) scale(1.02);
  box-shadow: 0 15px 30px rgba(0,0,0,0.3);
}

#bgCanvas {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: -1; /* Behind everything */
  background: radial-gradient(circle at top left, #0b1b3a, #020614);
}

.btn {
  background: linear-gradient(90deg, #1679f5, #45aaff);
  background-size: 200% 200%;
  animation: gradientShift 3s ease infinite;
}
@keyframes gradientShift {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}


    @media (max-width: 768px) { .contact-container { flex-direction: column; } }

    /* DESIGN VARIABLES */
    :root{ --bg-start:#0b1b3a; --bg-end:#020614; --primary:#4da6ff; --accent:#45aaff; --muted:#c0c9e9; --card-bg:rgba(255,255,255,0.04); }
    /* MOBILE NAV */
    .menu-toggle { display:none; background:transparent; border:none; color:var(--muted); font-size:1.2rem; cursor:pointer; }
    @media(max-width:768px){ header nav { display:none; position:fixed; top:64px; right:16px; background:rgba(2,6,20,0.95); padding:20px; border-radius:10px; box-shadow:0 10px 30px rgba(0,0,0,0.6); } header nav.show { display:block; } header nav a { display:block; margin:12px 0; }
    .menu-toggle { display:inline-block; }
    }

    /* MODAL */
    .modal { position:fixed; inset:0; display:flex; align-items:center; justify-content:center; background:rgba(0,0,0,0.6); opacity:0; pointer-events:none; transition:opacity 0.25s; }
    .modal.show { opacity:1; pointer-events:auto; }
    .modal-content { background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02)); padding:20px; border-radius:12px; max-width:900px; width:90%; color:#fff; box-shadow:0 30px 60px rgba(3,8,23,0.6); }
    .modal-img { width:100%; height:360px; object-fit:cover; border-radius:8px; }

    /* BACK TO TOP */
    .back-to-top { position:fixed; right:18px; bottom:18px; background:linear-gradient(90deg,var(--primary),var(--accent)); color:#fff; padding:10px 12px; border-radius:10px; display:none; cursor:pointer; box-shadow:0 8px 20px rgba(0,0,0,0.25); }

    html { scroll-behavior: smooth; }

    /* SECTION TITLE ACCENT */
    h2.section-title { position:relative; }
    h2.section-title::after { content:''; position:absolute; left:0; bottom:-14px; height:6px; width:80px; background:linear-gradient(90deg,var(--primary),var(--accent)); border-radius:6px; transform:scaleX(0); transform-origin:left; transition:transform 0.45s cubic-bezier(.2,.8,.2,1); }
    h2.section-title:hover::after, h2.section-title.show::after { transform:scaleX(1); }

    /* PROJECT CARD OVERLAY */
    .project-card { position:relative; }
    .project-card .overlay { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; background:linear-gradient(180deg, rgba(3,8,23,0.1), rgba(3,8,23,0.6)); opacity:0; pointer-events:none; transition:opacity 0.3s; }
    .project-card:hover .overlay, .project-card:focus .overlay { opacity:1; pointer-events:auto; }
    .project-card .overlay a { background:linear-gradient(90deg,var(--primary),var(--accent)); padding:10px 14px; border-radius:8px; color:#fff; font-weight:600; }

    /* FOCUS STYLES */
    .project-card:focus { outline:3px solid rgba(77,166,255,0.12); transform:translateY(-6px) scale(1.02); }

    /* BUTTON POLISH */
    .btn { border-radius:10px; padding:10px 16px; font-weight:600; box-shadow:0 8px 24px rgba(13,33,62,0.25); }
    
    /* FOCUS VISIBLE */
    :focus-visible { outline: 3px solid rgba(77,166,255,0.18); outline-offset:3px; }

    /* HERO IMAGE POLISH */
    .hero-img { box-shadow: 0 20px 60px rgba(2,6,20,0.6); border: 1px solid rgba(77,166,255,0.06); }
  </style>
</head>
<body>
  <canvas id="bgCanvas"></canvas>

  <!-- HEADER -->
  <header>
    <div class="logo">&lt;My Portfolio /&gt;</div>
    <div style="display:flex;align-items:center;gap:8px">
      <button class="menu-toggle" id="menuToggle" aria-label="Toggle menu">☰</button>
    </div>
    <nav id="mainNav" aria-label="Primary">
      <a href="#home">Home</a>
      <a href="#about">About</a>
      <a href="#projects">Projects</a>
      <a href="#skills">Skills</a>
      <a href="#contact">Contact</a>
    </nav>
  </header>

  <!-- HERO -->
  <section class="hero" id="home">
    <div class="hero-text">
      <h3>Hello, I'm</h3>
      <h1>Rey Pantorilla</h1>
      <h2>Aspiring Full Stack Developer</h2>
      <p>Passionate about building clean and modern websites while improving my skills every day. <br> Currently studying BSIS and developing digital solutions.</p>
      <a class="btn" href="#contact">Get In Touch</a>
      <a class="btn" href="#projects">View Projects</a>
    </div>
    <div class="hero-img">
      <img src="rere.jpeg" alt="Hero Image" loading="lazy">
    </div>
  </section>

  <!-- ABOUT -->
  <section id="about">
    <h2 class="section-title">About <span style="color:#4da6ff">Me</span></h2>
    <div class="about-container">
      <div class="about-intro">
        <img src="ree.jpeg" alt="Profile Picture" class="about-img">
        <p>
          Hello! I'm <strong>Rey Pantorilla</strong>, an aspiring Full Stack Developer and BSIS student. 
          I enjoy creating clean, modern websites and constantly improving my skills. 
          I'm passionate about building solutions that make life easier and collaborating with teams to deliver high-quality projects.
        </p>
      </div>
      <div class="about-boxes">
        <div class="about-card">
          <h3>My Journey</h3>
          <p>Learning web development and building real-world projects as a BSIS student.</p>
        </div>
        <div class="about-card">
          <h3>Clean Code</h3>
          <p>Writing scalable, maintainable, and readable code.</p>
        </div>
        <div class="about-card">
          <h3>Fast Learner</h3>
          <p>Quickly adapting to new tools, technologies, and frameworks.</p>
        </div>
        <div class="about-card">
          <h3>Team Player</h3>
          <p>Collaborative, supportive, and communicative in team projects.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- PROJECTS -->
  <section id="projects">
    <h2 class="section-title">Featured <span style="color:#4da6ff">Projects</span></h2>
    <div class="projects-grid">
          <div class="project-card" role="button" tabindex="0" data-title="Personal Portfolio Website" data-img="Screenshot 2025-11-21 184044.png" data-desc="Responsive portfolio with animations">
            <img src="Screenshot 2025-11-21 184044.png" alt="Portfolio Screenshot" loading="lazy"/>
            <div class="project-content">
              <h3>Personal Portfolio</h3>
              <p>Responsive portfolio with smooth animations and modern design.</p>
            </div>
            <div class="overlay"><a href="#" aria-hidden="true">View Project</a></div>
          </div>
      <div class="project-card" role="button" tabindex="0" data-title="Inventory System" data-img="Screenshot 2025-11-20 193940.png" data-desc="Inventory & POS system built with PHP/MySQL">
        <img src="Screenshot 2025-11-20 193917.png" alt="Inventory System" loading="lazy"/>
        <div class="project-content">
          <h3>Inventory System</h3>
          <p>Inventory & POS system built using PHP and MySQL.</p>
        </div>
        <div class="overlay"><a href="#" aria-hidden="true">View Project</a></div>
      </div>
      <div class="project-card" role="button" tabindex="0" data-title="Interactive To-Do List" data-img="project-manager-working-on-laptop-and-updating-tasks-and-milestones-progress-planning-with.webp" data-desc="To-do app with localstorage and animations">
        <img src="project-manager-working-on-laptop-and-updating-tasks-and-milestones-progress-planning-with.webp" alt="To-Do App" loading="lazy"/>
        <div class="project-content">
          <h3>Interactive To-Do List</h3>
          <p>To-do app with localStorage and smooth interactive animations.</p>
        </div>
        <div class="overlay"><a href="#" aria-hidden="true">View Project</a></div>
      </div>
    </div>
  </section>

  <!-- SKILLS -->
  <section id="skills">
    <h2 class="section-title">My <span>Skills</span></h2>
    <div class="skills-grid">
      <div class="skill-box"><div class="skill-name">HTML</div><div class="skill-bar"><div class="skill-bar-fill" data-width="90%"></div></div></div>
      <div class="skill-box"><div class="skill-name">CSS</div><div class="skill-bar"><div class="skill-bar-fill" data-width="85%"></div></div></div>
      <div class="skill-box"><div class="skill-name">JavaScript</div><div class="skill-bar"><div class="skill-bar-fill" data-width="80%"></div></div></div>
      <div class="skill-box"><div class="skill-name">PHP</div><div class="skill-bar"><div class="skill-bar-fill" data-width="75%"></div></div></div>
      <div class="skill-box"><div class="skill-name">MySQL</div><div class="skill-bar"><div class="skill-bar-fill" data-width="70%"></div></div></div>
      <div class="skill-box"><div class="skill-name">Bootstrap</div><div class="skill-bar"><div class="skill-bar-fill" data-width="80%"></div></div></div>
    </div>
  </section>

  <!-- CONTACT -->
  <!-- CONTACT -->
<section class="contact" id="contact">
  <h2 class="section-title">Contact <span style="color:#4da6ff">Me</span></h2>
  <div class="contact-container">
    <div class="contact-form">
      <form id="contactForm">
        <div class="input-group">
          <input type="text" id="name" required placeholder=" "/>
          <label for="name">Your Name</label>
        </div>
        <div class="input-group">
          <input type="email" id="email" required placeholder=" "/>
          <label for="email">Your Email</label>
        </div>
        <div class="input-group">
          <textarea id="message" rows="4" required placeholder=" "></textarea>
          <label for="message">Your Message</label>
        </div>
        <button type="submit" class="btn">Send Message</button>
        <p id="formFeedback" class="form-feedback"></p>
      </form>
      <div id="messageLogSection" class="message-log" style="width:100%;margin-top:18px;">
        <h4 style="color:var(--primary);margin-bottom:8px;">Saved Messages</h4>
        <div id="messageList" style="color:var(--muted);">No messages saved yet.</div>
        <button id="clearMessages" class="btn" style="margin-top:10px;display:none;">Clear All</button>
      </div>
      <div class="social-icons">
        <a href="https://github.com/pantorillarey-alt" target="_blank" rel="noopener noreferrer"><img src="github-mark-white.png" alt="GitHub" loading="lazy"></a>
        <a href="https://www.linkedin.com/in/rey-pantorilla-92b552392" target="_blank" rel="noopener noreferrer"><img src="linkedin.png" alt="LinkedIn" loading="lazy"></a>
        <a href="https://www.facebook.com/its.rere01" target="_blank" rel="noopener noreferrer"><img src="facebook.png" alt="Facebook" loading="lazy"></a>
      </div>
    </div>
    <div class="contact-info">
      <img src="ree.jpeg" alt="Contact illustration" class="contact-img" loading="lazy" />
      <div class="info-text">
        <p>Feel free to reach out to me for collaborations, questions, or project inquiries. I usually respond within 24 hours!</p>
        <p><strong>Email:</strong> pantorillareynamay@gmail.com</p>
        <p><strong>Phone:</strong> +63 915 325 4714</p>
      </div>
    </div>
  </div>
</section>

<!-- PROJECT MODAL -->
<div id="projectModal" class="modal" role="dialog" aria-hidden="true" aria-modal="true">
  <div class="modal-content" role="document">
    <button id="closeModal" aria-label="Close project" style="float:right;background:transparent;border:none;color:#c0c9e9;font-size:1.2rem;">✕</button>
    <img id="modalImg" class="modal-img" src="" alt="Project screenshot">
    <h3 id="modalTitle" style="margin-top:12px;color:#4da6ff"></h3>
    <p id="modalDesc" style="color:#c0c9e9"></p>
  </div>
</div>

<button id="backToTop" class="back-to-top" aria-label="Back to top">↑</button>

<!-- MESSAGE PREVIEW MODAL -->
<div id="messagePreviewModal" class="modal" role="dialog" aria-hidden="true" aria-modal="true">
  <div class="modal-content" role="document" style="max-width:640px;">
    <button id="closePreview" aria-label="Close preview" style="float:right;background:transparent;border:none;color:#c0c9e9;font-size:1.2rem;">✕</button>
    <h3 style="color:var(--primary);margin-top:2px;">Preview Message</h3>
    <p style="margin-top:8px;color:var(--muted);"><strong>Name:</strong> <span id="previewName"></span></p>
    <p style="color:var(--muted);"><strong>Email:</strong> <span id="previewEmail"></span></p>
    <div id="previewMessage" style="margin-top:12px;color:var(--muted);white-space:pre-wrap;border-left:3px solid rgba(77,166,255,0.08);padding-left:10px;"></div>
    <div style="margin-top:16px;display:flex;gap:8px;flex-wrap:wrap;">
      <button id="editMessage" class="btn">Edit</button>
      <button id="saveMessage" class="btn">Save Locally</button>
      <button id="sendMessage" class="btn">Send Email</button>
    </div>
  </div>
</div>

  <script>
    // HERO ANIMATION
    window.addEventListener('load', () => {
      document.querySelector('.hero').classList.add('show');
      document.querySelectorAll('.hero-text > *').forEach(el => el.classList.add('show'));
      document.querySelector('.hero-img').classList.add('show');
    });

    // SECTION SCROLL ANIMATION
    const observer = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        if(entry.isIntersecting){
          entry.target.classList.add('show');
        }
      });
    }, {threshold:0.2});
    document.querySelectorAll('section, .about-card, .project-card, .skill-box, .contact-img').forEach(el => observer.observe(el));

    // SKILL BAR ANIMATION
    const skillFills = document.querySelectorAll('.skill-bar-fill');
    const skillsSection = document.getElementById('skills');
    const skillObserver = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        if(entry.isIntersecting){
          skillFills.forEach(bar => bar.style.width = bar.dataset.width);
        }
      });
    }, {threshold:0.5});
    skillObserver.observe(skillsSection);

    // PROJECT MODAL
    document.querySelectorAll('.project-card').forEach(card => {
      card.addEventListener('mousemove', e => {
        const rect = card.getBoundingClientRect();
        const x = e.clientX - rect.left - rect.width/2;
        const y = e.clientY - rect.top - rect.height/2;
        card.style.transform = `perspective(900px) rotateX(${-y/rect.height*12}deg) rotateY(${x/rect.width*12}deg) scale(1.03)`;
      });
      card.addEventListener('mouseleave', () => card.style.transform = '');
    });

    


const canvas = document.getElementById('bgCanvas');
const ctx = canvas.getContext('2d');

let particlesArray = [];

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);

class Particle {
  constructor() {
    this.reset();
  }
  reset() {
    this.x = Math.random() * canvas.width;
    this.y = Math.random() * canvas.height;
    this.z = Math.random() * canvas.width; // depth for 3D effect
    this.size = Math.random() * 2 + 1;
    this.speed = Math.random() * 0.5 + 0.2;
  }
  update() {
    this.z -= this.speed;
    if (this.z <= 0) this.reset();
  }
  draw() {
    const px = (this.x - canvas.width / 2) * (canvas.width / this.z) + canvas.width / 2;
    const py = (this.y - canvas.height / 2) * (canvas.width / this.z) + canvas.height / 2;
    const radius = this.size * (canvas.width / this.z);
    ctx.beginPath();
    ctx.arc(px, py, radius, 0, Math.PI * 2);
    ctx.fillStyle = 'rgba(77, 166, 255, 0.7)';
    ctx.fill();
  }
}

function initParticles(num = 120) {
  particlesArray = [];
  for (let i = 0; i < num; i++) {
    particlesArray.push(new Particle());
  }
}
initParticles();

function animate() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  particlesArray.forEach(p => {
    p.update();
    p.draw();
  });
  requestAnimationFrame(animate);
}
animate();

// MOBILE MENU TOGGLE
const menuToggle = document.getElementById('menuToggle');
const mainNav = document.getElementById('mainNav');
menuToggle && menuToggle.addEventListener('click', () => {
  mainNav.classList.toggle('show');
  const expanded = mainNav.classList.contains('show');
  menuToggle.setAttribute('aria-expanded', expanded ? 'true' : 'false');
});
// Close mobile nav when selecting a link
document.querySelectorAll('#mainNav a').forEach(a => a.addEventListener('click', () => { mainNav.classList.remove('show'); menuToggle.setAttribute('aria-expanded','false'); }));

// (theme toggle removed per request)

// PROJECT MODAL HANDLERS
const modal = document.getElementById('projectModal');
const modalImg = document.getElementById('modalImg');
const modalTitle = document.getElementById('modalTitle');
const modalDesc = document.getElementById('modalDesc');
const closeModal = document.getElementById('closeModal');
function openModal(card){
  modalImg.src = card.dataset.img || '';
  modalImg.alt = card.dataset.title || 'Project screenshot';
  modalTitle.textContent = card.dataset.title || '';
  modalDesc.textContent = card.dataset.desc || '';
  modal.classList.add('show');
  modal.setAttribute('aria-hidden','false');
}
function closeProjectModal(){
  modal.classList.remove('show');
  modal.setAttribute('aria-hidden','true');
}
document.querySelectorAll('.project-card').forEach(card => {
  card.addEventListener('click', () => openModal(card));
  card.addEventListener('keydown', e => {
    if(e.key === 'Enter' || e.key === ' ') openModal(card);
  });
  // allow overlay button to act as same trigger
  const overlayBtn = card.querySelector('.overlay a');
  overlayBtn && overlayBtn.addEventListener('click', e => { e.preventDefault(); openModal(card); });
});
closeModal && closeModal.addEventListener('click', closeProjectModal);
modal && modal.addEventListener('click', e => { if(e.target === modal) closeProjectModal(); });

// BACK TO TOP
const backBtn = document.getElementById('backToTop');
window.addEventListener('scroll', () => {
  if(window.scrollY > 300) backBtn.style.display = 'block'; else backBtn.style.display = 'none';
});
backBtn && backBtn.addEventListener('click', () => window.scrollTo({top:0, behavior:'smooth'}));

// CONTACT FORM: preview/save/send logic + localStorage message log
const contactForm = document.getElementById('contactForm');
const previewModal = document.getElementById('messagePreviewModal');
const previewName = document.getElementById('previewName');
const previewEmail = document.getElementById('previewEmail');
const previewMessage = document.getElementById('previewMessage');
const closePreview = document.getElementById('closePreview');
const editMessageBtn = document.getElementById('editMessage');
const saveMessageBtn = document.getElementById('saveMessage');
const sendMessageBtn = document.getElementById('sendMessage');
const messageList = document.getElementById('messageList');
const clearMessages = document.getElementById('clearMessages');
const feedback = document.getElementById('formFeedback');

function supportsLocalStorage(){
  try { localStorage.setItem('__test','1'); localStorage.removeItem('__test'); return true; } catch(e){ return false; }
}

function openPreviewModal(){
  previewModal.classList.add('show');
  previewModal.setAttribute('aria-hidden','false');
  editMessageBtn.focus();
}
function closePreviewModal(){
  previewModal.classList.remove('show');
  previewModal.setAttribute('aria-hidden','true');
  document.querySelector('#contactForm button[type=submit]').focus();
}

function saveMessageToLocalStorage(msg){
  if(!supportsLocalStorage()){
    feedback.textContent = 'Local save not supported in this browser.';
    return;
  }
  const key = 'portfolioMessages';
  const existing = JSON.parse(localStorage.getItem(key) || '[]');
  existing.unshift(msg);
  localStorage.setItem(key, JSON.stringify(existing));
  feedback.textContent = 'Message saved locally.';
  renderMessageLog();
  setTimeout(()=> feedback.textContent = '', 3000);
}

function renderMessageLog(){
  if(!supportsLocalStorage()){
    messageList.textContent = 'Saving messages is not supported in this browser.';
    clearMessages.style.display = 'none';
    return;
  }
  const key = 'portfolioMessages';
  const existing = JSON.parse(localStorage.getItem(key) || '[]');
  if(existing.length === 0){
    messageList.textContent = 'No messages saved yet.';
    clearMessages.style.display = 'none';
    return;
  }
  messageList.innerHTML = '';
  existing.forEach((m, i) => {
    const card = document.createElement('div');
    card.style.borderLeft = '3px solid rgba(77,166,255,0.08)';
    card.style.padding = '8px 10px';
    card.style.marginBottom = '10px';
    card.innerHTML = `<div style="display:flex;justify-content:space-between;gap:8px;align-items:start;"><div style="flex:1"><strong style="color:var(--primary)">${m.name}</strong> <span style="color:var(--muted);font-size:0.9rem">— ${new Date(m.time).toLocaleString()}</span><div style="margin-top:6px;color:var(--muted);white-space:pre-wrap">${escapeHtml(m.message)}</div><div style="margin-top:6px;color:var(--muted);font-size:0.9rem">${m.email}</div></div><div><button class="btn" data-index="${i}" style="background:transparent;border:1px solid rgba(255,255,255,0.06);">Delete</button></div></div>`;
    messageList.appendChild(card);
  });
  clearMessages.style.display = 'inline-block';
  // attach delete handlers
  messageList.querySelectorAll('button[data-index]').forEach(btn => btn.addEventListener('click', e => {
    const idx = Number(btn.dataset.index);
    deleteMessage(idx);
  }));
}

function deleteMessage(idx){
  const key = 'portfolioMessages';
  const existing = JSON.parse(localStorage.getItem(key) || '[]');
  existing.splice(idx,1);
  localStorage.setItem(key, JSON.stringify(existing));
  renderMessageLog();
  feedback.textContent = 'Message deleted.';
  setTimeout(()=> feedback.textContent = '', 2000);
}

clearMessages && clearMessages.addEventListener('click', ()=>{
  if(!confirm('Clear all saved messages?')) return;
  localStorage.removeItem('portfolioMessages');
  renderMessageLog();
});

function escapeHtml(text){ return text.replace(/[&<>"']/g, function(c){ return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c]; }); }

if(contactForm){
  contactForm.addEventListener('submit', function(e){
    e.preventDefault();
    const name = document.getElementById('name').value.trim();
    const email = document.getElementById('email').value.trim();
    const message = document.getElementById('message').value.trim();
    if(!name || !email || !message){
      feedback.textContent = 'Please complete all required fields.';
      return;
    }
    // populate preview
    previewName.textContent = name;
    previewEmail.textContent = email;
    previewMessage.textContent = message;
    // store current values for actions
    previewModal.dataset.name = name;
    previewModal.dataset.email = email;
    previewModal.dataset.message = message;
    openPreviewModal();
  });
}

// preview modal actions
closePreview && closePreview.addEventListener('click', closePreviewModal);
editMessageBtn && editMessageBtn.addEventListener('click', () => { closePreviewModal(); document.getElementById('message').focus(); });
saveMessageBtn && saveMessageBtn.addEventListener('click', () => {
  const msg = { name: previewModal.dataset.name, email: previewModal.dataset.email, message: previewModal.dataset.message, time: Date.now() };
  saveMessageToLocalStorage(msg);
});
sendMessageBtn && sendMessageBtn.addEventListener('click', () => {
  const name = previewModal.dataset.name;
  const email = previewModal.dataset.email;
  const message = previewModal.dataset.message;
  const subject = encodeURIComponent(`Portfolio contact from ${name}`);
  const body = encodeURIComponent(`Name: ${name}\nEmail: ${email}\n\n${message}`);
  const mailto = `mailto:pantorillareynamay@gmail.com?subject=${subject}&body=${body}`;
  feedback.textContent = 'Opening mail client...';
  setTimeout(()=>{ window.location.href = mailto; contactForm.reset(); closePreviewModal(); setTimeout(()=> feedback.textContent = '', 4000); }, 400);
});

// keyboard: close preview with Escape
document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape' && previewModal.classList.contains('show')) closePreviewModal(); });

// render existing messages on load
document.addEventListener('DOMContentLoaded', () => renderMessageLog());

  </script>

</body>
</html>
